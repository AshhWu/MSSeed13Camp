function inherits(e,t){function a(){}a.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new a,e.prototype.constructor=e}function MarkerLabel_(e,t,a){this.marker_=e,this.handCursorURL_=e.handCursorURL,this.labelDiv_=document.createElement("div"),this.labelDiv_.style.cssText="position: absolute; overflow: hidden;",this.crossDiv_=MarkerLabel_.getSharedCross(t)}function MarkerWithLabel(e){e=e||{},e.labelContent=e.labelContent||"",e.labelAnchor=e.labelAnchor||new google.maps.Point(0,0),e.labelClass=e.labelClass||"markerLabels",e.labelStyle=e.labelStyle||{},e.labelInBackground=e.labelInBackground||!1,"undefined"==typeof e.labelVisible&&(e.labelVisible=!0),"undefined"==typeof e.raiseOnDrag&&(e.raiseOnDrag=!0),"undefined"==typeof e.clickable&&(e.clickable=!0),"undefined"==typeof e.draggable&&(e.draggable=!1),"undefined"==typeof e.optimized&&(e.optimized=!1),e.crossImage=e.crossImage||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/drag_cross_67_16.png",e.handCursor=e.handCursor||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/closedhand_8_8.cur",e.optimized=!1,this.label=new MarkerLabel_(this,e.crossImage,e.handCursor),google.maps.Marker.apply(this,arguments)}var app=angular.module("app",["chart.js"]);angular.module("app",["chart.js"]).directive("owlCarousel",function(){return{restrict:"E",transclude:!1,link:function(e){e.initCarousel=function(e){$(e).owlCarousel({items:4,lazyLoad:!0,autoPlay:5e3,rewindNav:!0,navigation:!0})}}}}).directive("owlCarouselItem",[function(){return{restrict:"A",transclude:!1,link:function(e,t){e.$last&&e.initCarousel(t.parent())}}}]),inherits(MarkerLabel_,google.maps.OverlayView),MarkerLabel_.getSharedCross=function(e){var t;return"undefined"==typeof MarkerLabel_.getSharedCross.crossDiv&&(t=document.createElement("img"),t.style.cssText="position: absolute; z-index: 1000002; display: none;",t.style.marginLeft="-8px",t.style.marginTop="-9px",t.src=e,MarkerLabel_.getSharedCross.crossDiv=t),MarkerLabel_.getSharedCross.crossDiv},MarkerLabel_.prototype.onAdd=function(){var e,t,a,r,i,o,n,s=this,l=!1,g=!1,m=20,p="url("+this.handCursorURL_+")",c=function(e){e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},u=function(){s.marker_.setAnimation(null)};this.getPanes().markerLayer.appendChild(this.labelDiv_),"undefined"==typeof MarkerLabel_.getSharedCross.processed&&(this.getPanes().markerLayer.appendChild(this.crossDiv_),MarkerLabel_.getSharedCross.processed=!0),this.listeners_=[google.maps.event.addDomListener(this.labelDiv_,"mouseover",function(e){(s.marker_.getDraggable()||s.marker_.getClickable())&&(this.style.cursor="pointer",google.maps.event.trigger(s.marker_,"mouseover",e))}),google.maps.event.addDomListener(this.labelDiv_,"mouseout",function(e){!s.marker_.getDraggable()&&!s.marker_.getClickable()||g||(this.style.cursor=s.marker_.getCursor(),google.maps.event.trigger(s.marker_,"mouseout",e))}),google.maps.event.addDomListener(this.labelDiv_,"mousedown",function(e){g=!1,s.marker_.getDraggable()&&(l=!0,this.style.cursor=p),(s.marker_.getDraggable()||s.marker_.getClickable())&&(google.maps.event.trigger(s.marker_,"mousedown",e),c(e))}),google.maps.event.addDomListener(document,"mouseup",function(t){var a;if(l&&(l=!1,s.eventDiv_.style.cursor="pointer",google.maps.event.trigger(s.marker_,"mouseup",t)),g){if(i){a=s.getProjection().fromLatLngToDivPixel(s.marker_.getPosition()),a.y+=m,s.marker_.setPosition(s.getProjection().fromDivPixelToLatLng(a));try{s.marker_.setAnimation(google.maps.Animation.BOUNCE),setTimeout(u,1406)}catch(e){}}s.crossDiv_.style.display="none",s.marker_.setZIndex(e),r=!0,g=!1,t.latLng=s.marker_.getPosition(),google.maps.event.trigger(s.marker_,"dragend",t)}}),google.maps.event.addListener(s.marker_.getMap(),"mousemove",function(r){var p;l&&(g?(r.latLng=new google.maps.LatLng(r.latLng.lat()-t,r.latLng.lng()-a),p=s.getProjection().fromLatLngToDivPixel(r.latLng),i&&(s.crossDiv_.style.left=p.x+"px",s.crossDiv_.style.top=p.y+"px",s.crossDiv_.style.display="",p.y-=m),s.marker_.setPosition(s.getProjection().fromDivPixelToLatLng(p)),i&&(s.eventDiv_.style.top=p.y+m+"px"),google.maps.event.trigger(s.marker_,"drag",r)):(t=r.latLng.lat()-s.marker_.getPosition().lat(),a=r.latLng.lng()-s.marker_.getPosition().lng(),e=s.marker_.getZIndex(),o=s.marker_.getPosition(),n=s.marker_.getMap().getCenter(),i=s.marker_.get("raiseOnDrag"),g=!0,s.marker_.setZIndex(1e6),r.latLng=s.marker_.getPosition(),google.maps.event.trigger(s.marker_,"dragstart",r)))}),google.maps.event.addDomListener(document,"keydown",function(e){g&&27===e.keyCode&&(i=!1,s.marker_.setPosition(o),s.marker_.getMap().setCenter(n),google.maps.event.trigger(document,"mouseup",e))}),google.maps.event.addDomListener(this.labelDiv_,"click",function(e){(s.marker_.getDraggable()||s.marker_.getClickable())&&(r?r=!1:(google.maps.event.trigger(s.marker_,"click",e),c(e)))}),google.maps.event.addDomListener(this.labelDiv_,"dblclick",function(e){(s.marker_.getDraggable()||s.marker_.getClickable())&&(google.maps.event.trigger(s.marker_,"dblclick",e),c(e))}),google.maps.event.addListener(this.marker_,"dragstart",function(e){g||(i=this.get("raiseOnDrag"))}),google.maps.event.addListener(this.marker_,"drag",function(e){g||i&&(s.setPosition(m),s.labelDiv_.style.zIndex=1e6+(this.get("labelInBackground")?-1:1))}),google.maps.event.addListener(this.marker_,"dragend",function(e){g||i&&s.setPosition(0)}),google.maps.event.addListener(this.marker_,"position_changed",function(){s.setPosition()}),google.maps.event.addListener(this.marker_,"zindex_changed",function(){s.setZIndex()}),google.maps.event.addListener(this.marker_,"visible_changed",function(){s.setVisible()}),google.maps.event.addListener(this.marker_,"labelvisible_changed",function(){s.setVisible()}),google.maps.event.addListener(this.marker_,"title_changed",function(){s.setTitle()}),google.maps.event.addListener(this.marker_,"labelcontent_changed",function(){s.setContent()}),google.maps.event.addListener(this.marker_,"labelanchor_changed",function(){s.setAnchor()}),google.maps.event.addListener(this.marker_,"labelclass_changed",function(){s.setStyles()}),google.maps.event.addListener(this.marker_,"labelstyle_changed",function(){s.setStyles()})]},MarkerLabel_.prototype.onRemove=function(){var e;for(this.labelDiv_.parentNode.removeChild(this.labelDiv_),e=0;e<this.listeners_.length;e++)google.maps.event.removeListener(this.listeners_[e])},MarkerLabel_.prototype.draw=function(){this.setContent(),this.setTitle(),this.setStyles()},MarkerLabel_.prototype.setContent=function(){var e=this.marker_.get("labelContent");"undefined"==typeof e.nodeType?this.labelDiv_.innerHTML=e:(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(e))},MarkerLabel_.prototype.setTitle=function(){this.labelDiv_.title=this.marker_.getTitle()||""},MarkerLabel_.prototype.setStyles=function(){var e,t;this.labelDiv_.className=this.marker_.get("labelClass"),this.labelDiv_.style.cssText="",t=this.marker_.get("labelStyle");for(e in t)t.hasOwnProperty(e)&&(this.labelDiv_.style[e]=t[e]);this.setMandatoryStyles()},MarkerLabel_.prototype.setMandatoryStyles=function(){this.labelDiv_.style.position="absolute",this.labelDiv_.style.overflow="hidden","undefined"!=typeof this.labelDiv_.style.opacity&&""!==this.labelDiv_.style.opacity&&(this.labelDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity='+100*this.labelDiv_.style.opacity+')"',this.labelDiv_.style.filter="alpha(opacity="+100*this.labelDiv_.style.opacity+")"),this.setAnchor(),this.setPosition(),this.setVisible()},MarkerLabel_.prototype.setAnchor=function(){var e=this.marker_.get("labelAnchor");this.labelDiv_.style.marginLeft=-e.x+"px",this.labelDiv_.style.marginTop=-e.y+"px"},MarkerLabel_.prototype.setPosition=function(e){var t=this.getProjection().fromLatLngToDivPixel(this.marker_.getPosition());"undefined"==typeof e&&(e=0),this.labelDiv_.style.left=Math.round(t.x)+"px",this.labelDiv_.style.top=Math.round(t.y-e)+"px",this.setZIndex()},MarkerLabel_.prototype.setZIndex=function(){var e=this.marker_.get("labelInBackground")?-1:1;"undefined"==typeof this.marker_.getZIndex()?this.labelDiv_.style.zIndex=parseInt(this.labelDiv_.style.top,10)+e:this.labelDiv_.style.zIndex=this.marker_.getZIndex()+e},MarkerLabel_.prototype.setVisible=function(){this.marker_.get("labelVisible")?this.labelDiv_.style.display=this.marker_.getVisible()?"block":"none":this.labelDiv_.style.display="none"},inherits(MarkerWithLabel,google.maps.Marker),MarkerWithLabel.prototype.setMap=function(e){google.maps.Marker.prototype.setMap.apply(this,arguments),this.label.setMap(e)},angular.module("app",["chart.js"]).controller("BarCtrl",function(e){e.labels=["2006","2007","2008","2009","2010","2011","2012"],e.series=["Series A","Series B"],e.data=[[65,59,80,81,56,55,40],[28,48,40,19,86,27,90]]}),angular.module("app",["chart.js"]).controller("cubeController",["$scope","cubeService","$interval",function(e,t,a){function r(){t.getCube().then(function(t){console.log("cube get"),e.cubes=t},function(e){console.log("cube error: "+e.message)})}a(r,2e3)}]),angular.module("app",["chart.js"]).controller("locationController",["$scope","$interval","flagService",function(e,t,a){function r(){a.getLocation().then(function(t){for(var a in t){var r=t[a];console.log(r),console.log(e.markers[r.Team]),"null"!=r.location&&(void 0===e.markers[r.Team]?(console.log("Create new marker"),e.markers[r.Team]=new MarkerWithLabel({position:new google.maps.LatLng(r.gpsX,r.gpsY),draggable:!0,raiseOnDrag:!0,map:n,icon:e.teamInfo[r.Team].picture,labelContent:e.teamInfo[r.Team].team,labelAnchor:new google.maps.Point(22,0),labelClass:"labels",labelStyle:{opacity:.8}})):(console.log("Move"),e.markers[r.Team].setPosition(new google.maps.LatLng(r.gpsX,r.gpsY))))}},function(e){console.log("error: "+e.message)})}e.markers=[];var i=new google.maps.LatLng(25.054056,121.539021),o=document.getElementById("map-canvas"),n=new google.maps.Map(o,{zoom:14,center:i,mapTypeId:google.maps.MapTypeId.ROADMAP});e.teamInfo=a.getTeamInfo(),t(r,5e3)}]),angular.module("app",["chart.js"]).controller("picController",["$scope","picService","$interval",function(e,t,a){function r(){for(var t=1;t<=e.pics.length;t++)e.pics[t].picture="img/TeamPicture/"+t+".jpg?"+(new Date).getTime(),console.log(e.pics[t].picture)}e.pics=t.getPics(),a(r,2e3)}]),angular.module("app",["chart.js"]).service("cubeService",["$http",function(e){var t=[{team:"NULL"},{team:"美國"},{team:"加拿大"},{team:"巴西"},{team:"義大利"},{team:"德國"},{team:"英國"},{team:"台灣"},{team:"日本"},{team:"泰國"},{team:"南非"},{team:"馬達加斯加"},{team:"埃及"}];this.getTeamInfo=function(){return t},this.getCube=function(){return e.get("scripts/CURD/getCube.php")}}]),angular.module("app").service("flagService",["$http",function(e){var t=[{team:"NULL",picture:"img/flag/台灣.png"},{team:"美國",picture:"img/flag/美國.png"},{team:"加拿大",picture:"img/flag/加拿大.png"},{team:"巴西",picture:"img/flag/巴西.png"},{team:"義大利",picture:"img/flag/義大利.png"},{team:"德國",picture:"img/flag/德國.png"},{team:"英國",picture:"img/flag/英國.png"},{team:"台灣",picture:"img/flag/台灣.png"},{team:"日本",picture:"img/flag/日本.png"},{team:"泰國",picture:"img/flag/泰國.png"},{team:"南非",picture:"img/flag/南非.png"},{team:"馬達加斯加",picture:"img/flag/馬達加斯加.png"},{team:"埃及",picture:"img/flag/埃及.png"}];this.getTeamInfo=function(){return t},this.getLocation=function(){return e.get("scripts/CURD/getLocation.php")}}]),angular.module("app").service("picService",function(){var e=[{team:"NULL",picture:"img/TeamPicture/1.jpg"},{team:"美國",picture:"img/TeamPicture/1.jpg"},{team:"加拿大",picture:"img/TeamPicture/2.jpg"},{team:"巴西",picture:"img/TeamPicture/3.jpg"},{team:"義大利",picture:"img/TeamPicture/4.jpg"},{team:"德國",picture:"img/TeamPicture/5.jpg"},{team:"英國",picture:"img/TeamPicture/6.jpg"},{team:"台灣",picture:"img/TeamPicture/7.jpg"},{team:"日本",picture:"img/TeamPicture/8.jpg"},{team:"泰國",picture:"img/TeamPicture/9.jpg"},{team:"南非",picture:"img/TeamPicture/10.jpg"},{team:"馬達加斯加",picture:"img/TeamPicture/11.jpg"},{team:"埃及",picture:"img/TeamPicture/12.jpg"}];this.getPics=function(){return e}});